<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Achievement Jar</title>

<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:'Patrick Hand',cursive;
  background:linear-gradient(to bottom,#fffdfc,#ffeef3);
  text-align:center;
  color:#444;
}

.wrapper{
  max-width:900px;
  margin:auto;
  padding:20px;
}

h1{
  color:#ff6f91;
  font-size:clamp(24px,5vw,40px);
}

.jar-container{
  margin:40px auto;
  width:clamp(220px,50vw,360px);
  aspect-ratio: 5 / 4;
  border:5px solid #ff8fab;
  border-radius:40px;
  background:white;
  position:relative;
  overflow:hidden;
}

canvas{
  position:absolute;
  top:0;
  left:0;
}

.wrapper p,
.emoji-list{
  text-align:left;
}

#progressText{
  color:#ff6f91;
  margin-top:15px;
}

.emojis{
  margin-top:20px;
}
.emoji-list {
  list-style: none;
  padding-left: 0;   /* removes left spacing */
}
button{
  font-size:clamp(20px,5vw,26px);
  margin:3px;
  padding:6px 6px;
  border:none;
  border-radius:14px;
  background:white;
  cursor:pointer;
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
}

button:disabled{
  opacity:0.5;
}

.reset-btn{
  background:white;
  border:3px dashed #ff8fab;
  color:#ff6f91;
  border-radius:20px;
  padding:6px 16px;
  font-size:20px;
  transition:0.2s;
}

.reset-btn:hover{
  background:#ffeef3;
}

#celebration{
  display:none;
  margin-top:20px;
  color:#ff3e6c;
}
</style>
</head>

<body>

<div class="wrapper">
<h1>âœ¨ My Achievement Jar âœ¨</h1>
<p>
First of all, Iâ€™m sooo happy and proud of you!! I donâ€™t even know what youâ€™ve achieved yet (come and yap all about it to me right now!!). Oh waitttt â€” before thatâ€¦ I have a small jar for you to fill.
Fill it with all your achievements, no matter how big or small.
</p>

<ul class="emoji-list">
  <li>ğŸ©· Did something creative</li>
  <li>ğŸŒ· Felt pretty after putting on makeup</li>
  <li>ğŸª» Finally did something youâ€™ve been putting off for so long</li>
  <li>ğŸ•¯ï¸ Exam went well</li>
  <li>ğŸ¡ Did something youâ€™re proud of</li>
  <li>ğŸ¨ Let yourself rest with no guilt</li>
</ul>

<p>Drop your wins into the jar ğŸ’–</p>

<div class="jar-container" id="jar"></div>

<div id="progressText">0% Filled</div>

<div class="emojis">
  <button onclick="dropEmoji('ğŸ©·')">ğŸ©·</button>
  <button onclick="dropEmoji('ğŸŒ·')">ğŸŒ·</button>
  <button onclick="dropEmoji('ğŸª»')">ğŸª»</button>
  <button onclick="dropEmoji('ğŸ•¯ï¸')">ğŸ•¯ï¸</button>
  <button onclick="dropEmoji('ğŸ¡')">ğŸ¡</button>
  <button onclick="dropEmoji('ğŸ¨')">ğŸ¨</button>
</div>

<div id="celebration">
ğŸ‰ YOU FILLED THE JAR!! Screenshot this ğŸ’–  
<br>
<button class="reset-btn" onclick="resetJar()">Fill it again ğŸ«¶</button>
</div>
</div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
const { Engine, Render, World, Bodies, Runner } = Matter;

const jar = document.getElementById("jar");
const progressText = document.getElementById("progressText");
const celebration = document.getElementById("celebration");
const buttons = document.querySelectorAll(".emojis button");

let progress = 0;
let drops = []; // âœ… ADDED

function initPhysics(){

  const width = jar.clientWidth;
  const height = jar.clientHeight;

  const engine = Engine.create();
  engine.world.gravity.y = 1.2;
  const world = engine.world;

  const render = Render.create({
    element: jar,
    engine: engine,
    options:{
      width:width,
      height:height,
      wireframes:false,
      background:'transparent'
    }
  });

  Render.run(render);
  Runner.run(Runner.create(), engine);

  const thickness = 50;

  const ground = Bodies.rectangle(width/2, height+thickness/2, width, thickness, { isStatic:true });
  const leftWall = Bodies.rectangle(-thickness/2, height/2, thickness, height, { isStatic:true });
  const rightWall = Bodies.rectangle(width+thickness/2, height/2, thickness, height, { isStatic:true });

  World.add(world,[ground,leftWall,rightWall]);

  return {engine,world,width,height};
}

let physics = initPhysics();

function dropEmoji(symbol){
  if(progress >= 100) return;

  progress += 5;
  if(progress > 100) progress = 100;

  drops.push(symbol); // âœ… SAVE SYMBOL

  localStorage.setItem("jarData", JSON.stringify({ // âœ… SAVE STATE
    progress: progress,
    drops: drops
  }));

  const { world, width } = physics;

  const radius = width * 0.08;
  const x = Math.random() * (width - radius*2) + radius;

  const emoji = Bodies.circle(x, -30, radius, {
    restitution:0.15,
    friction:0.9,
    frictionAir:0.03,
    density:0.003,
    render:{
      sprite:{
        texture:createEmojiTexture(symbol, radius*2),
        xScale:1,
        yScale:1
      }
    }
  });

  World.add(world, emoji);

  updateProgress();

  if(progress === 100) celebrate();
}

// âœ… FUNCTION TO RESTORE SAVED EMOJIS
function dropSavedEmoji(symbol){
  const { world, width } = physics;

  const radius = width * 0.08;
  const x = Math.random() * (width - radius*2) + radius;

  const emoji = Bodies.circle(x, -30, radius, {
    restitution:0.15,
    friction:0.9,
    frictionAir:0.03,
    density:0.003,
    render:{
      sprite:{
        texture:createEmojiTexture(symbol, radius*2),
        xScale:1,
        yScale:1
      }
    }
  });

  World.add(world, emoji);
}

function createEmojiTexture(symbol,size){
  const canvas = document.createElement("canvas");
  canvas.width = size;
  canvas.height = size;
  const ctx = canvas.getContext("2d");
  ctx.font = size*0.8 + "px serif";
  ctx.textAlign="center";
  ctx.textBaseline="middle";
  ctx.fillText(symbol,size/2,size/2);
  return canvas.toDataURL();
}

function updateProgress(){
  progressText.innerText = progress + "% Filled";
}

function celebrate(){
  celebration.style.display="block";
  buttons.forEach(btn=>btn.disabled=true);

  confetti({
    particleCount:180,
    spread:90,
    origin:{y:0.6}
  });
}

function resetJar(){
  localStorage.removeItem("jarData"); // âœ… CLEAR STORAGE
  location.reload();
}

// âœ… RESTORE ON PAGE LOAD
window.addEventListener("load", () => {
  const saved = localStorage.getItem("jarData");

  if(saved){
    const data = JSON.parse(saved);

    progress = data.progress || 0;
    drops = data.drops || [];

    updateProgress();

    drops.forEach(symbol=>{
      dropSavedEmoji(symbol);
    });

    if(progress >= 100){
      celebrate();
    }
  }
});

// Reinitialize on resize
window.addEventListener("resize",()=>{
  jar.innerHTML="";
  physics = initPhysics();

  // âœ… RE-DRAW EMOJIS AFTER RESIZE
  drops.forEach(symbol=>{
    dropSavedEmoji(symbol);
  });
});
</script>

</body>
</html>

